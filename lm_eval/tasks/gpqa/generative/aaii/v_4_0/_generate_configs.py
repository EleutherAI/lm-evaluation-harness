import yaml
from tqdm import tqdm


def main() -> None:
    variants = ["non_reasoning", "reasoning"]
    base_include = "_gpqa_diamond_generative_zeroshot_aaii_v_4_0_yaml"
    for var in tqdm(variants):
        file_name = f"gpqa_diamond_generative_zeroshot_aaii_v_4_0_{var}.yaml"
        payload = {
            "include": base_include,
            "task": f"gpqa_diamond_generative_zeroshot_aaii_v_4_0_{var}",
        }

        # Generation kwargs differ for non-reasoning vs reasoning
        gen_kwargs = {
            "until": ["</s>", "Question:", "<|im_end|>"],
            "temperature": 0.0,
        }
        if var == "non_reasoning":
            gen_kwargs["max_gen_toks"] = 16_384

        payload["generation_kwargs"] = gen_kwargs

        # For reasoning variant, include recommended model args (thinking defaults) in metadata
        if var == "reasoning":
            payload.setdefault("metadata", {})
            payload["metadata"]["default_model_args"] = {
                "enable_thinking": True,
                "think_end_token": "<|message|>",
            }

        try:
            with open(file_name, "w") as f:
                f.write("# Generated by _generate_configs.py\n")
                yaml.dump(payload, f)
        except FileExistsError:
            pass


if __name__ == "__main__":
    main()
